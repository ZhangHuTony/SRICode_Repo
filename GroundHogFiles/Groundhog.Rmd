---
title: "Groundhog DTMC"
author: "Montana Ferita"
date: "2024-02-01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Due Feb 7th \@ 11:59pm**

# Questions

**In your own words, describe what a discrete time markov chain is?** - A stochastic system which state is influenced by the previous state.

**Punxsutawney Phil is nervous about his big day and he keeps practicing going inside and outside of his hole. Suppose the probability he leaves his hole is 0.4 and the probability he goes back in his hole is 0.3. What are the conditional probabilities?** - Pr($I_t|O_{t-1}$): 0.4 - Pr($O_t|I_{t-1}$): 0.3

# Model Creation

**Write the discrete-time dynamical system of equations.** Note to write an equation, you need to put it in double dollar signs. To create a subscript, like $$A_{b+c}$$ you need to use the curly braces. However, if you subscript is only one letter, than you only need to use the underscore, $$A_b$$. The double backslash symbol creates a new line.

$$
O_{t+1} = 0.4
I_{t+1} = 0.3 
$$

# Long-term Probability

**Find the long-term probability Punxsutawney is outside.** - $O^* = \frac{4}{7}$

# Simulation

**Create a discrete time Markov Chain model of Punxsutawney going inside and outside of his hole. Suppose the he starts inside and run this model for 100 time steps. For each line of the code, describe what the line is doing.**
```{r}

#Define number of steps
numSteps <- 100

#Create list which will hold states of all steps (inside or outside)
statesList <- numeric(numSteps)
#starts inside
statesList[1] = 1
#1 denotes inside and 2 denotes outside
states <- c(1,2)

#Create matrix for all probabilities
statesBefore <- c("previously inside", "previously outside")
statesAfter <- c("now inside", "now outside")
probINIB<- 0.6
probONIB<-0.4
probINOB<- 0.3
probONOB<-0.7

Transition<-matrix(c(probINIB,probINOB,probONIB,probONOB),nrow=2,dimnames = list(statesBefore,statesAfter))

#takes 100 hundred samples, using matrix and previous state as index to choose the probabilites for the states
for(i in 2:numSteps){
  statesList[i] = sample(states, 1, prob = Transition[statesList[i-1],] )
}

```


**Now create a graph showing when Punxsutawney goes inside and outside of his hole. Count the number of times he is outside. Does this agree with the long-term probability? (Do not count by hand)**

```{r}
plot(statesList)
print(sum(statesList == 2))
```
56 is very close to 4/7 so yes it does agree with th elong term probability

**Congrats, you did it! Please submit both your markdown file and the html file (click on knit-\>knit to html) on Canvas.**
