---
title: "Exercise 5.5.47"
author: "Tony Zhang"
format: html
editor: visual
---

## Exercise 5.2.49:

-   Suppose meiotic drive affects the pollen only and that 80% of the pollen grains from a heterozygote carry the A allele. Ovules are normal and 50% of them carry the A allele. What fraction of offspring from aselfing heterozygote will be heterozygous?

```{r}

numHeteOffSpring = 0
for(n in 1:9999)
for(offSpring in 1:100){
  isA_Pollen_Allele = runif(1) <= 0.8
  isA_Ovule_Allele = runif(1) <= 0.5

  if ((isA_Pollen_Allele && !isA_Ovule_Allele) || (!isA_Pollen_Allele && isA_Ovule_Allele)){
    numHeteOffSpring = numHeteOffSpring + 1
  }
  
}
numHeteOffSpring/9999

```

## Exercise 5.2.50:

-   Suppose meiotic drive affects both pollen and ovules and that 80% of the pollen grains and ovules from aheterozygote carry the A allele. What fraction of offspring from a selfing heterozygote will be heterozygous?

```{r}
numHeteOffSpring = 0
for(n in 1:9999)
for(offSpring in 1:100){
  isA_Pollen_Allele = runif(1) <= 0.8
  isA_Ovule_Allele = runif(1) <= 0.8

  if ((isA_Pollen_Allele && !isA_Ovule_Allele) || (!isA_Pollen_Allele && isA_Ovule_Allele)){
    numHeteOffSpring = numHeteOffSpring + 1
  }
  
}
numHeteOffSpring/9999

```

```{r}
# Set the parameters
num_offspring <- 100
pollen_drive_rate <- 0.8
ovule_drive_rate <- 0.5

# Function to simulate meiotic drive and calculate fraction of heterozygous offspring
simulate_meiotic_drive <- function(num_offspring, pollen_drive_rate, ovule_drive_rate) {
  # Initialize count for heterozygous offspring
  heterozygous_count <- 0
  
  # Simulate each offspring
  for (i in 1:num_offspring) {
    # Randomly select allele from pollen with meiotic drive
    pollen_allele <- sample(c("A", "a"), 1, prob = c(pollen_drive_rate, 1 - pollen_drive_rate), replace = TRUE)
    
    # Randomly select allele from ovule
    ovule_allele <- sample(c("A", "a"), 1, prob = c(ovule_drive_rate, 1 - ovule_drive_rate), replace = TRUE)
    
    # Check if the offspring is heterozygous
    if (pollen_allele != ovule_allele) {
      heterozygous_count <- heterozygous_count + 1
    }
  }
  
  # Calculate the fraction of heterozygous offspring
  fraction_heterozygous <- heterozygous_count / num_offspring
  
  return(fraction_heterozygous)
}

# Run the simulation
fraction_heterozygous <- simulate_meiotic_drive(num_offspring, pollen_drive_rate, ovule_drive_rate)

# Print the result
cat("Fraction of heterozygous offspring:", fraction_heterozygous, "\n")

```
